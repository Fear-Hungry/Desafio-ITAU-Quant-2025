universe: configs/universe_liquid.yaml
base_currency: BRL
benchmark:
  name: ACWI60_AGG40_BRUnhedged

rebalancing:
  frequency: monthly
  day_rule: first_business_day
  turnover_target: [0.05, 0.20]

risk_limits:
  vol_annual_max: 0.20
  cvar_alpha: 0.95
  cvar_max: 0.12
  max_drawdown: 0.20

fx:
  net_exposure_abs_max: 0.30
  hedge_ratio_default: 0.30
  hedge_ratio_defensive: 0.70

optimizer:
  objective: mean_variance
  lambda: 4.0
  solver: osqp
  solver_kwargs:
    verbose: true
  max_weight: 0.10 # 10% cap per asset
  min_weight: 0.005 # 0.5% floor

# Transaction costs by asset class
costs:
  scheme: "per_asset_class"
  default_cost_bps: 15.0
  round_trip_bps:
    us_equities_core: 8 # SPY, QQQ, IWM
    us_sectors_factors: 10 # XLC-XLU, USMV, MTUM, QUAL, VLUE, SIZE
    dev_ex_us: 12 # EFA, VGK, VPL, EWJ, EWG, EWU
    em_equities: 15 # EEM, EWZ, MCHI, INDA, EZA
    reits_us: 12 # VNQ, O, PSA
    reits_ex_us: 28 # VNQI
    treasuries: 6 # SHY, IEI, IEF, TLT
    tips: 8 # TIP, VGSH, VGIT
    ig_credit: 12 # AGG, LQD, VCIT, VCSH, MUB, BNDX
    high_yield: 18 # HYG
    em_bonds_usd: 20 # EMB
    em_bonds_local: 32 # EMLC
    commodities_gold: 8 # GLD, SLV, PPLT
    commodities_basket: 28 # DBC, DBA, CORN, USO, UNG
    usd_fx: 12 # UUP
    crypto_btc: 45 # FBTC, IBIT, GBTC
    crypto_eth: 55 # ETHA, ETHE

# Cardinality: Dynamic K based on N_eff + cost
cardinality:
  enable: true
  mode: "dynamic_neff_cost"
  k_min: 12
  k_max: 32
  neff_multiplier: 0.8 # K ≈ 0.8 · N_eff

  # Smart scoring weights
  score_weight: 1.0 # Prefer higher QP weights
  score_turnover: -0.2 # Penalize turnover
  score_return: 0.1 # Bonus for higher expected return
  score_cost: -0.15 # Penalize expensive assets

  tie_breaker: "low_turnover"
  min_active_weight: 0.005
  epsilon: 0.0001

# Group constraints (asset class caps)
group_constraints:
  equity:
    max_weight: 0.40
    assets_regex: "(SPY|QQQ|IWM|EFA|VGK|VPL|EWJ|EWG|EEM|EWZ|MCHI|INDA|EZA|EWU|XLC|XLY|XLP|XLE|XLF|XLV|XLK|XLI|XLB|XLRE|XLU|USMV|MTUM|QUAL|VLUE|SIZE|VYM|SCHD|SPLV|VUG|VTV)"

  commodities:
    max_weight: 0.35
    assets_regex: "(GLD|SLV|PPLT|DBC|DBA|CORN|USO|UNG)"

  crypto:
    max_weight: 0.10
    assets_regex: "(FBTC|IBIT|GBTC|ETHA|ETHE)"

  fixed_income:
    max_weight: 0.40
    assets_regex: "(AGG|TLT|IEF|IEI|SHY|TIP|VGSH|VGIT|LQD|HYG|MUB|VCIT|VCSH|EMB|EMLC|BNDX)"

  reits:
    max_weight: 0.15
    assets_regex: "(VNQ|VNQI|O|PSA)"

estimators:
  mu: { method: shrunk_50, window_days: 252, strength: 0.5 }
  sigma: { method: ledoit_wolf, window_days: 252, nonlinear: true }

reporting:
  metrics:
    [
      sharpe_hac,
      sortino,
      vol,
      cvar5,
      maxdd,
      turnover,
      costs_bps,
      te_benchmark,
      hit_rate,
    ]

walkforward:
  train_days: 252
  test_days: 21
  purge_days: 2
  embargo_days: 2
  n_splits: 50
